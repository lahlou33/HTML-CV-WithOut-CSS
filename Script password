import subprocess
import re

def get_wifi_passwords():
    data = {}

    # Fetch the list of saved Wi-Fi profiles
    try:
        output = subprocess.check_output("netsh wlan show profiles", shell=True, text=True)
    except subprocess.CalledProcessError as e:
        print("Error fetching profiles:", e)
        return data

    # Find all profile names in the output using a regex
    profiles = re.findall(r"All User Profile\s*:\s*(.*)", output)
    for profile in profiles:
        profile = profile.strip()
        try:
            # Run the command to show the profile details with the key in clear text
            profile_info = subprocess.check_output(f'netsh wlan show profile "{profile}" key=clear', shell=True, text=True)
            # Search for the line containing the key (password)
            match = re.search(r"Key Content\s*:\s*(.*)", profile_info)
            password = match.group(1).strip() if match else "None (open network or password not found)"
            data[profile] = password
        except subprocess.CalledProcessError as e:
            data[profile] = f"Error: {e}"
    return data

if __name__ == "__main__":
    wifi_passwords = get_wifi_passwords()
    for profile, password in wifi_passwords.items():
        pri
import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class WifiPasswords {

    public static void main(String[] args) {
        try {
            // Run command to show all profiles.
            Process process = Runtime.getRuntime().exec("netsh wlan show profiles");
            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            Pattern profilePattern = Pattern.compile("All User Profile\\s*:\\s*(.*)");
            
            while ((line = reader.readLine()) != null) {
                Matcher profileMatcher = profilePattern.matcher(line);
                if (profileMatcher.find()) {
                    String profileName = profileMatcher.group(1).trim();
                    System.out.println("Profile: " + profileName);

                    // Run command for each profile to get details including the password.
                    String command = "netsh wlan show profile name=\"" + profileName + "\" key=clear";
                    Process processDetail = Runtime.getRuntime().exec(command);
                    BufferedReader detailReader = new BufferedReader(new InputStreamReader(processDetail.getInputStream()));
                    String detailLine;
                    Pattern keyPattern = Pattern.compile("Key Content\\s*:\\s*(.*)");
                    boolean found = false;
                    
                    while ((detailLine = detailReader.readLine()) != null) {
                        Matcher keyMatcher = keyPattern.matcher(detailLine);
                        if (keyMatcher.find()) {
                            System.out.println("Password: " + keyMatcher.group(1).trim());
                            found = true;
                            break;
                        }
                    }
                    if (!found) {
                        System.out.println("Password: Not found or it might be an open network.");
                    }
                    detailReader.close();
                }
            }
            reader.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}nt(f"{profile}: {password}") unt 
